<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE testproblem SYSTEM "regressiontest.dtd">

<testproblem>
  <name>gls-relax</name>
  <owner userid="jhill1"/>
  <tags>flml gls</tags>
    <problem_definition length="short" nprocs="1">
        <command_line>fluidity -v3 -l gls-relax.flml;
        </command_line>
  </problem_definition>  
  <variables>     
      <variable name="NormalVertDiffStart" language="python">
import fluidity_tools
NormalVertDiffStart = fluidity_tools.stat_parser("gls-MixedLayer-ke_checkpoint.stat")['Fluid']['GLSVerticalDiffusivity']['max'][0]
    </variable>     
    <variable name="NormalVertDiffEnd" language="python">
import fluidity_tools
NormalVertDiffEnd = fluidity_tools.stat_parser("gls-MixedLayer-ke_checkpoint.stat")['Fluid']['GLSVerticalDiffusivity']['max'][-1]
    </variable>    
      <variable name="NormalVertViscStart" language="python">
import fluidity_tools
NormalVertViscStart = fluidity_tools.stat_parser("gls-MixedLayer-ke_checkpoint.stat")['Fluid']['GLSVerticalViscosity']['max'][0]
    </variable>     
    <variable name="NormalVertViscEnd" language="python">
import fluidity_tools
NormalVertViscEnd = fluidity_tools.stat_parser("gls-MixedLayer-ke_checkpoint.stat")['Fluid']['GLSVerticalViscosity']['max'][-1]
    </variable>     
    <variable name="RelaxVertDiffEnd" language="python">
import fluidity_tools
RelaxVertDiffEnd = fluidity_tools.stat_parser("gls-relax.stat")['Fluid']['GLSVerticalDiffusivity']['max'][-1]
    </variable>  
    <variable name="RelaxVertViscEnd" language="python">
import fluidity_tools
RelaxVertViscEnd = fluidity_tools.stat_parser("gls-relax.stat")['Fluid']['GLSVerticalViscosity']['max'][-1]
    </variable>    
    <variable name="RelaxVertDiffStart" language="python">
import fluidity_tools
RelaxVertDiffStart = fluidity_tools.stat_parser("gls-relax.stat")['Fluid']['GLSVerticalDiffusivity']['max'][0]
    </variable>  
    <variable name="RelaxVertViscStart" language="python">
import fluidity_tools
RelaxVertViscStart = fluidity_tools.stat_parser("gls-relax.stat")['Fluid']['GLSVerticalViscosity']['max'][0]
    </variable>
</variables>

  <pass_tests> 
      <test name ="Relaxed diffusivity is half value of normal" language="python">
normalDiffChange = NormalVertDiffEnd-NormalVertDiffStart
relaxDiffChange = RelaxVertDiffEnd-RelaxVertDiffStart
PredictedDifference = ((NormalVertDiffEnd-NormalVertDiffStart)/2.0) - relaxDiffChange
print PredictedDifference
assert (  -0.0005 &lt; PredictedDifference &lt; +0.0005 )
    </test>
    <test name ="Relaxed Viscosity is half value of normal" language="python">
normalViscChange = NormalVertViscEnd-NormalVertViscStart
relaxViscChange = RelaxVertViscEnd-RelaxVertViscStart
PredictedDifference = ((NormalVertViscEnd-NormalVertViscStart)/2.0) - relaxViscChange
print PredictedDifference
assert (  -0.0005 &lt; PredictedDifference &lt; +0.0005 )
    </test>

  </pass_tests>
</testproblem>
