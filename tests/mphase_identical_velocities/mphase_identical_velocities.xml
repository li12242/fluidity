<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE testproblem SYSTEM "regressiontest.dtd">

<testproblem>
   
  <name>mphase_identical_velocities</name>
  <owner userid="ctj10"/>
  <tags>flml</tags>
  
  <problem_definition length="medium" nprocs="1">
    <command_line>make run</command_line>
    <!-- 2D test case to check that the two velocity fields are identical. -->
	 <!-- This is basically a stripped-down copy of the driven_cavity example (see examples/driven_cavity), -->
	 <!-- but two prognostic velocity fields are solved for here instead of one. -->
  </problem_definition>
  
  <variables>
    <variable name="f1_u1" language="python">
from fluidity_tools import stat_parser
s = stat_parser("mphase_identical_velocities.stat")
f1_u1=s["Fluid1"]["Velocity%1"]["integral"]
    </variable>
    
    <variable name="f1_u2" language="python">
from fluidity_tools import stat_parser
s = stat_parser("mphase_identical_velocities.stat")
f1_u2=s["Fluid1"]["Velocity%2"]["integral"]
    </variable>
    
    <variable name="f2_u1" language="python">
from fluidity_tools import stat_parser
s = stat_parser("mphase_identical_velocities.stat")
f2_u1=s["Fluid2"]["Velocity%1"]["integral"]
    </variable>
    
    <variable name="f2_u2" language="python">
from fluidity_tools import stat_parser
s = stat_parser("mphase_identical_velocities.stat")
f2_u2=s["Fluid2"]["Velocity%2"]["integral"]
    </variable>
  </variables>
    
  <pass_tests>
    <test name="Velocities are identical" language="python">
assert max(abs(f1_u1 - f2_u1)) &lt; 1e-6
assert max(abs(f1_u2 - f2_u2)) &lt; 1e-6
    </test>
  </pass_tests>
  
  <warn_tests>
  </warn_tests>
  
</testproblem>
